# 数学题答案解析功能 - Proposal

## Why

学生与自学者需要针对单道数学题获得分步解析与图示，以理解解题过程而非仅得到答案。需要支持通过上传题目图片（含截图）或输入题目文字两种方式提交题目，并得到与步骤一一对应的文字解析与多张讲解图，且公式在全链路中正确展示、不乱码。

## What Changes

- **题目输入**：提供图形界面，支持用户上传题目图片（含截图）或直接输入/粘贴题目文字；不做拍照入口，上传与文字为并列入口。
- **答案解析生成**：后端基于题目文本（图片需先识图转为文本）生成分步文字解析；解析结构为「步骤」序列，每步可绑定一段文字与一张讲解图。
- **讲解图生成**：为每个解析步骤生成一张对应讲解图，多张图与步骤一一对应；不限制题型，首版以模型生成图为主。
- **结果展示**：前端按步骤展示文字解析与配图（一步一文一图），公式使用 LaTeX 统一渲染，保证正确性、不乱码；支持步骤导航与图片放大等交互。
- **视频方案**：将多张步骤图整合为讲解视频的方案写入设计文档，作为**后续待办（Phase 2）**，本期不实现。
- **技术栈**：后端 Go + langchaingo；前端 Vue 3；全链路公式以 LaTeX 表示，前端用统一渲染器（如 KaTeX）。

## Capabilities

### New Capabilities

- `problem-input`：题目输入。覆盖上传题目图片（含截图）与输入题目文字两种方式，以及识别结果的可编辑与提交解析的入口。
- `explanation-generation`：答案解析生成。覆盖从统一题目文本到分步文字解析与步骤对应讲解图的生成（识图、大模型解析、配图生成）。
- `explanation-display`：解析结果展示。覆盖按步骤展示文字与配图、公式正确渲染、步骤导航与图片查看等 UI 与交互。

### Modified Capabilities

- 无（无现有 spec 需变更）。

## Impact

- **后端**：新增 Go 服务，使用 langchaingo 调用大模型；需接入多模态/识图能力（图片→题目文本）、文生图或绘图能力（步骤→配图）；存储与接口设计需支持步骤化结构。
- **前端**：新增 Vue 3 应用，包含上传/输入页、解析中状态、结果页（步骤列表 + 文字 + 图 + 公式渲染）；需引入 KaTeX（或等价）用于公式渲染。
- **依赖与运维**：大模型 API、识图与绘图服务；异步任务与存储若解析耗时长则需考虑队列与任务状态。
