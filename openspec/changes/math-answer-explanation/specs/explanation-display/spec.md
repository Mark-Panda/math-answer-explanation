# Capability: explanation-display

解析结果展示：按步骤展示文字解析与配图，公式正确渲染，支持步骤导航与图片查看等交互；注重界面交互友好性。

## ADDED Requirements

### Requirement: 按步骤展示文字与配图

系统 SHALL 以步骤为单元展示解析结果：每个步骤 SHALL 展示该步的标题/序号、该步文字解析内容与该步对应的一张讲解图（一步一文一图）。

#### Scenario: 步骤与内容对应展示

- **WHEN** 用户查看解析结果页
- **THEN** 每个步骤块 SHALL 包含该步的文字与唯一对应的配图，顺序与解析逻辑一致

#### Scenario: 某步无配图时的降级

- **WHEN** 某步骤因生成失败等原因无配图
- **THEN** 系统 SHALL 展示该步文字，配图区域 SHALL 显示占位或“本步无配图”等提示，不破坏步骤顺序

### Requirement: 公式正确渲染且不乱码

系统 SHALL 使用统一公式渲染方式（如 KaTeX）渲染正文中的 LaTeX 公式；渲染结果 SHALL 正确显示、无乱码、无截断，与文字排版协调。

#### Scenario: 正文中公式渲染

- **WHEN** 解析结果中包含 LaTeX 公式（行内或块级）
- **THEN** 前端 SHALL 将其渲染为正确数学符号，字号与行距与文字协调

#### Scenario: 公式不出现乱码

- **WHEN** 用户查看含公式的解析
- **THEN** 公式 SHALL 不以乱码、叠字或错误编码形式展示

### Requirement: 支持步骤导航与浏览

当步骤较多时，系统 SHALL 提供便于跳转或浏览的交互（如步骤导航、锚点或折叠），使首屏不过载且用户可快速定位到某一步。

#### Scenario: 步骤多时的导航

- **WHEN** 解析结果包含多个步骤
- **THEN** 用户 SHALL 能够通过导航或锚点快速定位到指定步骤

#### Scenario: 首屏体验

- **WHEN** 用户进入结果页
- **THEN** 布局与展示方式 SHALL 避免单屏信息过载，兼顾可读性与查找效率

### Requirement: 支持图片放大查看

系统 SHALL 支持用户点击步骤配图进行放大查看（如灯箱/弹层），便于查看细节。

#### Scenario: 点击配图放大

- **WHEN** 用户点击某步骤的讲解图
- **THEN** 系统 SHALL 以放大或全屏方式展示该图，并 SHALL 提供关闭或返回的入口

### Requirement: 解析中状态明确

在解析生成进行中时，系统 SHALL 展示明确的等待状态（如“解析中…”、“正在生成步骤解析与配图”等文案及加载指示），不得出现长时间白屏。

#### Scenario: 解析进行中

- **WHEN** 用户已提交题目且后端正在生成解析
- **THEN** 前端 SHALL 显示加载状态或进度提示，直至结果返回或失败

#### Scenario: 解析耗时较长

- **WHEN** 单次请求耗时较长（如超过数秒）
- **THEN** 系统 SHALL 采用异步或轮询等方式维持可感知的进度，并 SHALL 在超时或失败时给出明确提示

### Requirement: 界面交互友好

系统 SHALL 在输入方式、错误提示、结果展示与操作入口上注重交互友好：入口清晰、错误可恢复、主要操作易于发现与使用。

#### Scenario: 双入口清晰

- **WHEN** 用户进入题目输入页
- **THEN** 「上传题目图片」与「输入题目文字」两个入口 SHALL 明显且易于理解

#### Scenario: 错误可恢复

- **WHEN** 出现识图失败、解析失败或网络错误
- **THEN** 系统 SHALL 给出明确说明并 SHALL 提供重新上传、重试或改为文字输入等可操作入口
